<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tickets</title>
    <style>
        /* Reset */
        body, h1, h2, table, th, td {
            margin: 0;
            padding: 0;
        }

        /* Base styles */
        body {
            font-family: Arial, sans-serif;
            background: rgba(242, 242, 242, 0.9) url('https://wallpaperaccess.com/full/740895.jpg') no-repeat center center fixed;
            background-size: cover;
        }

        /* Header */
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background-color: #008080;
            color: white;
        }
        
        header h1 {
            font-size: 24px;
        }

        /* Cover Page */
        .cover-page {
            text-align: center;
            padding: 20px;
            background-color: #008080;
            color: white;
        }

        /* Main Content */
        .main-content {
            max-width: 800px;
            margin: 20px auto;
            padding: 20px;
            background-color: #fff;
            border: 1px solid #ddd;
            border-radius: 5px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }
        
        /* Section Headings */
        .main-content h2 {
            border-bottom: 1px solid #ddd;
            margin-bottom: 10px;
            padding-bottom: 5px;
        }

        /* Calendar Section */
        .calendar {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 10px 0;
        }

        /* Guest Section */
        .guests div {
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }

        .guests label, .duration label {
            width: 150px;
        }

        .guests button, .duration button {
            width: 30px;
            height: 30px;
            background-color: #f2f2f2;
            border: 1px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .guests input, .duration input, .calendar input {
            padding: 5px 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            outline: none;
        }

        /* Duration Section */
        .duration select {
            width: 100%;
        }

        /* Tables */
        table {
            width: 100%;
            border-collapse: collapse;
        }
        
        th, td {
            padding: 10px;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #f2f2f2;
        }

        /* Book Now Button */
        #book-now-button {
            display: block;
            margin: 20px auto 0;
            padding: 10px 20px;
            font-size: 18px;
            font-weight: bold;
            color: white;
            background-color: #007bff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            outline: none;
            transition: background-color 0.3s ease;
        }

        #book-now-button:hover {
            background-color: #0056b3;
        }

        /* Footer */
        footer {
            background-color: #008080;
            color: white;
            padding: 10px;
            text-align: center;
            position: absolute;
            bottom: 0;
            width: 100%;
        }
        
        footer p {
            margin: 0;
        }
    </style>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/flatpickr@4.6.9/dist/flatpickr.min.css">
</head>

<body>
    <div class="cover-page">
        <h1>Buy Tickets</h1>
    </div>
    <div class="main-content">
        <section class="dates">
            <h2>Dates</h2>
            <div class="calendar">
                <input type="text" id="date-picker" placeholder="Select a date">
            </div>
        </section>
        <section class="guests">
            <h2>Guests</h2>
            <div>
                <label for="sl-adult">SL Adult:</label>
                <button id="sl-adult-minus">-</button>
                <input type="number" id="sl-adul+" min="0" max="10" value="0">
                <button id="sl-adult-plus">+</button>
            </div>
            <div>
                <label for="sl-child">SL Child:</label>
                <button id="sl-child-minus">-</button>
                <input type="number" id="sl-child" min="0" max="10" value="0">
                <button id="sl-child-plus">+</button>
            </div>
            <div>
                <label for="foreigner-adult">Foreigner Adult:</label>
                <button id="foreigner-adult-minus">-</button>
                <input type="number" id="foreigner-adult" min="0" max="10" value="0">
                <button id="foreigner-adult-plus">+</button>
            </div>
            <div>
                <label for="foreigner-child">Foreigner Child:</label>
                <button id="foreigner-child-minus">-</button>
                <input type="number" id="foreigner-child" min="0" max="10" value="0">
                <button id="foreigner-child-plus">+</button>
            </div>
            <div>
                <label for="infant">Infant:</label>
                <button id="infant-minus">-</button>
                <input type="number" id="infant" min="0" max="10" value="0">
                <button id="infant-plus">+</button>
            </div>
        </section>
        <section class="duration">
            <h2>Duration</h2>
            <select id="duration-dropdown">
                <!-- Options for time slots -->
                <!-- Populate these options dynamically using JavaScript -->
                <option value="slot-1">7.00am - 8.00am</option>
                <option value="slot-2">8.00am - 9.00am</option>
                <option value="slot-3">9.00am - 10.00am</option>
                <option value="slot-4">10.00am - 11.00am</option>
                <option value="slot-5">11.00am - 12.00pm</option>
                <option value="slot-6">12.00pm - 01.00pm</option>
                <option value="slot-7">01.00pm - 02.00pm</option>
                <option value="slot-8">02.00pm - 03.00pm</option>
                <option value="slot-9">03.00pm - 04.00pm</option>
                <option value="slot-10">04.00pm - 05.00pm</option>
                <option value="slot-11">05.00pm - 06.00pm</option>
            </select>
        </section>
        <section class="pricing-table">
            <h2>Pricing Table</h2>
            <table>
                <tr>
                    <th>Category</th>
                    <th>Charge per hour</th>
                </tr>
				 
				 <tr>
                    <td>Peak hour for Foreigner Adult</td>
                    <td>13USD</td>
                </tr>
                <tr>
                    <td>Foreigner Adult</td>
                    <td>10 USD</td>
               </tr>
			 <tr>
                    <td>Peak hour for Foreigner Child</td>
                    <td>8 USD</td>
                </tr>
                <tr>
                    <td>Foreigner Child</td>
                    <td>5 USD</td>
                </tr>
				  <tr>
                    <td>Peak hour  or SL Adult</td>
                    <td>6 USD</td>
                </tr>
                <tr>
                    <td>SL Adult</td>
                    <td>4 USD</td>
                </tr>
				<tr>
                    <td>Peak hour for SL Child</td>
                    <td> 3 USD</td>
                </tr>
				
                <tr>
                    <td>SL Child</td>
                    <td>2 USD</td>
                </tr>
				 
                <tr>
                    <td>Infant (SL or Foreigner) (under 4 years)</td>
                    <td>Free</td>
                </tr>
            </table>
        </section>
        <section class="summary-table">
            <h2>Summary Table</h2>
            <!-- Summary table to display the selected options and total payable -->
            <!-- You can style this table using CSS -->
            <table id="summary-table">
                <!-- Summary table content will be updated dynamically by JavaScript -->
            </table>
        </section>
        <a href="details.html"><button id="book-now-button">Book now</button></a>   
    </div>


    <script src="https://cdn.jsdelivr.net/npm/flatpickr@4.6.9/dist/flatpickr.min.js"></script>
    <script>
        peekhr = 0;
        normalhr = 0;
        document.addEventListener("DOMContentLoaded", function () {
            const calendarContainer = document.querySelector(".calendar");
            const guestsSection = document.querySelector(".guests");
            const durationDropdown = document.getElementById("duration-dropdown");
            const pricingTableSection = document.querySelector(".pricing-table");
            const summaryTableSection = document.querySelector(".summary-table");
            const bookNowButton = document.getElementById("book-now-button");

            // Function to initialize Flatpickr date picker
            function initializeDatePicker() {
                const datePicker = flatpickr("#date-picker", {
                    mode: "single", // Allow only single date selection
                    dateFormat: "Y-m-d", // Date format: Year-Month-Day (e.g., 2023-07-23)
                    onClose: function (selectedDates, dateStr, instance) {
                        // Store the selected date in the browser's local storage
                        localStorage.setItem("selectedDate", dateStr);
                        updateSummaryTable();
                    },
                });

                // Check if there is a previously selected date in the local storage and set it in the date picker
                const storedDate = localStorage.getItem("selectedDate");
                if (storedDate) {
                    datePicker.setDate(storedDate);
                }
            }

            // Function to dynamically populate the duration dropdown options based on the time slots
    function populateDurationDropdown() {
        const startTime = 7; // Start time in 24-hour format (07:00 am)
        const endTime = 18; // End time in 24-hour format (06:00 pm)
        const peakStartTime = 15; // Peak start time in 24-hour format (03:00 pm)
        const peakEndTime = 18; // Peak end time in 24-hour format (06:00 pm)

        const durationDropdown = document.getElementById("duration-dropdown");

        // Function to format time in 24-hour format to 12-hour format
        function formatTime(hour) {
            return `${hour % 12 || 12}:00 ${hour < 12 ? "am" : "pm"}`;
        }

        for (let hour = startTime; hour < endTime; hour++) {
            const isPeak = hour >= peakStartTime && hour <= peakEndTime;
            const optionValue = `${formatTime(hour)} - ${formatTime(hour + 1)} ${isPeak ? "(Peak)" : ""}`;
            const option = document.createElement("option");

            option.value = optionValue;
            option.textContent = optionValue;

            durationDropdown.appendChild(option);

            // If the next hour is not within the peak hours, add an additional option for multiple consecutive hours
            if (isPeak && hour + 1 > peakEndTime || !isPeak && hour + 1 > endTime) {
                const nextHour = hour + 1;
                const endHour = isPeak ? peakEndTime : endTime;

                const consecutiveOptionValue = `${formatTime(hour)} - ${formatTime(endHour)} ${isPeak ? "(Peak)" : ""}`;
                const consecutiveOption = document.createElement("option");

                consecutiveOption.value = consecutiveOptionValue;
                consecutiveOption.textContent = consecutiveOptionValue;

                durationDropdown.appendChild(consecutiveOption);
            }
        }
    } 


        function calculateTotalPayable() {
        const priceForeignerAdult = 10;
        const priceForeignerChild = 5;
        const priceSLAdult = 4;
        const priceSLChild = 2;
        const pricePeakForeignerAdult = 13;
        const pricePeakForeignerChild = 8;
        const pricePeakSLAdult = 6;
        const pricePeakSLChild = 3;

        const slAdults = parseInt(document.getElementById("sl-adult").value);
        const slChildren = parseInt(document.getElementById("sl-child").value);
        const foreignerAdults = parseInt(document.getElementById("foreigner-adult").value);
        const foreignerChildren = parseInt(document.getElementById("foreigner-child").value);
        const infants = parseInt(document.getElementById("infant").value);
        const duration = durationDropdown.value;

        // Check if the selected time slot is a peak hour
        const isPeakHour = duration.includes("(Peak)");

        let totalForeignerAdult;
        let totalForeignerChild;
        let totalSLAdult;
        let totalSLChild;

        if (isPeakHour) {
            totalForeignerAdult = foreignerAdults * pricePeakForeignerAdult;
            totalForeignerChild = foreignerChildren * pricePeakForeignerChild;
            totalSLAdult = slAdults * pricePeakSLAdult;
            totalSLChild = slChildren * pricePeakSLChild;
        } else {
            totalForeignerAdult = foreignerAdults * priceForeignerAdult;
            totalForeignerChild = foreignerChildren * priceForeignerChild;
            totalSLAdult = slAdults * priceSLAdult;
            totalSLChild = slChildren * priceSLChild;
        }

        const totalInfant = 0; // Infants are free

        return totalForeignerAdult + totalForeignerChild + totalSLAdult + totalSLChild + totalInfant;
    }
    // Function to update the summary table with the selected options and total payable
    function updateSummaryTable() {
        const summaryTable = document.getElementById("summary-table");
        const selectedDate = localStorage.getItem("selectedDate");
        const duration = document.getElementById("duration-dropdown").value;
        const slAdults = document.getElementById("sl-adult").value;
        const slChildren = document.getElementById("sl-child").value;
        const foreignerAdults = document.getElementById("foreigner-adult").value;
        const foreignerChildren = document.getElementById("foreigner-child").value;
        const infants = document.getElementById("infant").value;

        //arranging time slots
        const s1 = null;
        const s2 = null;
        const s3 = null;
        const s4 = null;
        const s5 = null;
        const s6 = null;
        const s7 = null;
        const s8 = null;
        const s9 = null;
        const s10= null;
        const s11 = null;

        if (duration == "slot-1"){
            s1 = "7.00am to 8.00am";
        }else if(duration == "slot-2"){
            s2 = "8.00am to 9.00am";
        }else if(duration == "slot-3"){
            s3 = "9.00am to 10.00am";
        }else if(duration == "slot-4"){
            s4 = "10.00am to 11.00am";
        }else if(duration == "slot-5"){
            s5 = "11.00am to 12.00pm";
        }else if(duration == "slot-6"){
            s6 = "12.00pm to 1.00pm";
        }else if(duration == "slot-7"){
            s7 = "1.00pm to 2.00pm";
        }else if(duration == "slot-8"){
            s8 = "2.00pm to 3.00pm";
        }else if(duration == "slot-9"){
            s9 = "3.00pm to 4.00pm";
        }else if(duration == "slot-10"){
            s10 = "4.00pm to 5.00pm";
        }else if(duration == "slot-11"){
            s11 = "5.00 to 6.00";
        }


        // Check if the selected time slot is a peak hour
        const isPeakHour = duration.includes("(Peak)");

        // Calculate total payable amount
        const totalPayable = calculateTotalPayable();

        // Update the summary table content
        summaryTable.innerHTML = `
            <tr>
                <td>Date:</td>
                <td>${selectedDate}</td>
            </tr>
            <tr>
                <td>Duration:</td>
                <td>
                    <div id="s_1">${s1}</div>
                    <div id="s_2">${s2}</div>
                    <div id="s_3">${s3}</div>
                    <div id="s_4">${s4}</div>
                    <div id="s_5">${s5}</div>
                    <div id="s_6">${s6}</div>
                    <div id="s_7">${s7}</div>
                    <div id="s_8">${s8}</div>
                    <div id="s_9">${s9}</div>
                    <div id="s_10">${s10}</div>
                    <div id="s_11">${s11}</div>
                </td>
            </tr>
            <tr>
                <td>Foreigner Adult:</td>
                <td>${foreignerAdults}</td>
            </tr>
            <tr>
                <td>Foreigner Child:</td>
                <td>${foreignerChildren}</td>
            </tr>
            <tr>
                <td>SL Adult:</td>
                <td>${slAdults}</td>
            </tr>
            <tr>
                <td>SL Child:</td>
                <td>${slChildren}</td>
            </tr>
            <tr>
                <td>Infant:</td>
                <td>${infants}</td>
            </tr>
            <tr>
                <td>Peak Hour:</td>
                <td>${isPeakHour ? "Yes" : "No"}</td>
            </tr>
            <tr>
                <td>Total Payable:</td>
                <td>${totalPayable} USD</td>
            </tr>
        `;
    }

            // Function to handle the plus and minus buttons for incrementing and decrementing guests
            function handleGuestButtons() {
                const buttons = guestsSection.querySelectorAll("button");
                buttons.forEach((button) => {
                    const input = button.parentElement.querySelector("input");
                    const step = parseInt(input.step) || 1;

                    button.addEventListener("click", () => {
                        if (button.id.includes("plus")) {
                            input.value = Math.min(parseInt(input.value) + step, parseInt(input.max));
                        } else if (button.id.includes("minus")) {
                            input.value = Math.max(parseInt(input.value) - step, parseInt(input.min));
                        }

                        updateSummaryTable();
                    });
                });
            }

     // Function to handle the "Book now" button click event
            function handleBookNowButtonClick() {
                const selectedDate = localStorage.getItem("selectedDate");
                const duration = durationDropdown.value;
                const slAdults = document.getElementById("sl-adult").value;
                const slChildren = document.getElementById("sl-child").value;
                const foreignerAdults = document.getElementById("foreigner-adult").value;
                const foreignerChildren = document.getElementById("foreigner-child").value;
                const infants = document.getElementById("infant").value;

                // Store the summary table data in the local storage
                const summaryTableData = {
                    selectedDate,
                    duration,
                    slAdults,
                    slChildren,
                    foreignerAdults,
                    foreignerChildren,
                    infants,
                    totalPayable: calculateTotalPayable(),
                };
                localStorage.setItem("summaryTableData", JSON.stringify(summaryTableData));

                // Redirect to the next page with the selected data as query parameters
                window.location.href = `detail.html?${new URLSearchParams(summaryTableData).toString()}`;
         
            wndow.location.href = `confirm.html?${new URLSearchParams(summaryTableData).toString()}`;
            }

            // Add event listeners and call the necessary functions
            initializeDatePicker();
            populateDurationDropdown();
            updateSummaryTable();
            handleGuestButtons();
            bookNowButton.addEventListener("click", handleBookNowButtonClick);
        });
    </script>
</body>


</html>